{% extends "base/__normal.html" %}
{% load bootstrap4 %}

{% block title %}Backup List{% endblock %}
{% load tags %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Backup List</h2>

    <div class="mb-4">
        <form method="post" action="{% url 'manual_backup' %}">
            {% csrf_token %}
            <div class="input-group">
                <input type="text" name="backup_name" class="form-control" pattern="[^_]*" title="Underscores are not allowed." required>
                <button type="submit" class="btn btn-primary">Create Backup</button>
            </div>
        </form>
    </div>
    <div class="d-flex justify-content-between align-items-center mb-4">
        <!-- Filter by Round -->
        <div>
            <label for="round-filter" class="form-label">Filter by Round</label>
            <select id="round-filter" class="form-select">
            </select>
        </div>
        <a href="/upload_backup/" class="btn btn-secondary">Upload Backup</a>
    </div>

    {% quick_search %}

    <!-- Backup Table -->
    <table class="table table-striped table-bordered" id="backup-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Round</th>
                <th>Timestamp</th>
            </tr>
        </thead>
        <tbody>
            {% for key, name, type, round, timestamp in backups %}
            <tr class="searchable" data-round="{{ round }}">
                <td>
                    <a href="/backup/{{ key }}">{{ name }}</a>
                </td>
                <td>{{ type }}</td>
                <td>{{ round }}</td>
                <td>{{ timestamp }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">No backups found</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
